# DevOps CI/CD: Jenkins, Argo CD, EKS, & Terraform

–¶–µ–π –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î –ø–æ–≤–Ω–∏–π —Ü–∏–∫–ª **CI/CD** (Continuous Integration / Continuous Delivery) —Ç–∞ **GitOps** –ø—ñ–¥—Ö–æ–¥—ñ–≤ –¥–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è Django-–∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –≤ Kubernetes (EKS). 

–Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–µ—Ä—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ **Terraform**, –∑–±—ñ—Ä–∫–∞ —Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤ ‚Äî —á–µ—Ä–µ–∑ **Jenkins**, –∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è —Å—Ç–∞–Ω—É –∫–ª–∞—Å—Ç–µ—Ä–∞ ‚Äî —á–µ—Ä–µ–∑ **Argo CD**.

---

## üìã –ó–∞–≤–¥–∞–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É

1.  **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ (IaC):** –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è EKS, ECR, VPC, Jenkins —Ç–∞ Argo CD –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Terraform.
2.  **Continuous Integration (CI):** 
    *   –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∑–±—ñ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑—É Django-–∑–∞—Å—Ç–æ—Å—É–Ω–∫—É.
    *   –ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –æ–±—Ä–∞–∑—É –≤ Amazon ECR.
3.  **Continuous Delivery (CD) / GitOps:**
    *   –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó –æ–±—Ä–∞–∑—É (—Ç–µ–≥—É) —É Helm-—á–∞—Ä—Ç—ñ (–≤ Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó).
    *   Argo CD –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ–º—ñ—á–∞—î –∑–º—ñ–Ω–∏ –≤ Git —Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î —Å—Ç–∞–Ω –∫–ª–∞—Å—Ç–µ—Ä–∞ (Deployments, Services, ConfigMaps).

---

## üèó –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Ç–∞ –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

*   **Cloud Provider:** AWS (EKS, ECR, VPC, S3, DynamoDB, IAM).
*   **Infrastructure as Code:** Terraform.
*   **CI Server:** Jenkins (Running on K8s, using Kubernetes Agent & Kaniko for Docker builds).
*   **CD / GitOps:** Argo CD (App of Apps pattern).
*   **Package Manager:** Helm.
*   **Application:** Python Django.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```bash
lesson-8-9/
‚îÇ
‚îÇ
‚îú‚îÄ‚îÄ main.tf                  # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –º–æ–¥—É–ª—ñ–≤
‚îú‚îÄ‚îÄ backend.tf               # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–µ–∫–µ–Ω–¥—É –¥–ª—è —Å—Ç–µ–π—Ç—ñ–≤ (S3 + DynamoDB)
‚îú‚îÄ‚îÄ outputs.tf               # –ó–∞–≥–∞–ª—å–Ω—ñ –≤–∏–≤–æ–¥–∏ —Ä–µ—Å—É—Ä—Å—ñ–≤
‚îÇ
‚îú‚îÄ‚îÄ modules/                 # –ö–∞—Ç–∞–ª–æ–≥ –∑ —É—Å—ñ–º–∞ –º–æ–¥—É–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ s3-backend/          # –ú–æ–¥—É–ª—å –¥–ª—è S3 —Ç–∞ DynamoDB
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ s3.tf            # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è S3-–±–∞–∫–µ—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dynamodb.tf      # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è DynamoDB
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf     # –ó–º—ñ–Ω–Ω—ñ –¥–ª—è S3
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf       # –í–∏–≤–µ–¥–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ S3 —Ç–∞ DynamoDB
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ vpc/                 # –ú–æ–¥—É–ª—å –¥–ª—è VPC
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vpc.tf           # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è VPC, –ø—ñ–¥–º–µ—Ä–µ–∂, Internet Gateway
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes.tf        # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf     # –ó–º—ñ–Ω–Ω—ñ –¥–ª—è VPC
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf       # –í–∏–≤–µ–¥–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ VPC
‚îÇ   ‚îú‚îÄ‚îÄ ecr/                 # –ú–æ–¥—É–ª—å –¥–ª—è ECR
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ecr.tf           # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è ECR —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf     # –ó–º—ñ–Ω–Ω—ñ –¥–ª—è ECR
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf       # –í–∏–≤–µ–¥–µ–Ω–Ω—è URL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ eks/                 # –ú–æ–¥—É–ª—å –¥–ª—è Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ eks.tf           # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–ª–∞—Å—Ç–µ—Ä–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ node.tf          # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–¥-–≥—Ä—É–ø–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aws_ebs_csi_driver.tf # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–ª–∞–≥—ñ–Ω—É csi drive
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf     # –ó–º—ñ–Ω–Ω—ñ –¥–ª—è EKS
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf       # –í–∏–≤–µ–¥–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –∫–ª–∞—Å—Ç–µ—Ä
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ jenkins/             # –ú–æ–¥—É–ª—å –¥–ª—è Helm-—É—Å—Ç–∞–Ω–æ–≤–∫–∏ Jenkins
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jenkins.tf       # Helm release –¥–ª—è Jenkins
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ variables.tf     # –ó–º—ñ–Ω–Ω—ñ (—Ä–µ—Å—É—Ä—Å–∏, –∫—Ä–µ–¥–µ–Ω—à–µ–ª–∏, values)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ providers.tf     # –û–≥–æ–ª–æ—à–µ–Ω–Ω—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ values.yaml      # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è jenkins
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf       # –í–∏–≤–æ–¥–∏ (URL, –ø–∞—Ä–æ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
‚îÇ   ‚îÇ 
‚îÇ   ‚îî‚îÄ‚îÄ argo_cd/             # ‚úÖ –ù–æ–≤–∏–π –º–æ–¥—É–ª—å –¥–ª—è Helm-—É—Å—Ç–∞–Ω–æ–≤–∫–∏ Argo CD
‚îÇ       ‚îú‚îÄ‚îÄ jenkins.tf       # Helm release –¥–ª—è Jenkins
‚îÇ       ‚îú‚îÄ‚îÄ variables.tf     # –ó–º—ñ–Ω–Ω—ñ (–≤–µ—Ä—Å—ñ—è —á–∞—Ä—Ç–∞, namespace, repo URL —Ç–æ—â–æ)
‚îÇ       ‚îú‚îÄ‚îÄ providers.tf     # Kubernetes+Helm.  –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ –∑ –º–æ–¥—É–ª—è jenkins
‚îÇ       ‚îú‚îÄ‚îÄ values.yaml      # –ö–∞—Å—Ç–æ–º–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Argo CD
‚îÇ       ‚îú‚îÄ‚îÄ outputs.tf       # –í–∏–≤–æ–¥–∏ (hostname, initial admin password)
‚îÇ		‚îî‚îÄ‚îÄcharts/                  # Helm-—á–∞—Ä—Ç –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è app'—ñ–≤
‚îÇ 	 	    ‚îú‚îÄ‚îÄ Chart.yaml
‚îÇ	  	    ‚îú‚îÄ‚îÄ values.yaml          # –°–ø–∏—Å–æ–∫ applications, repositories
‚îÇ			‚îî‚îÄ‚îÄ templates/
‚îÇ		        ‚îú‚îÄ‚îÄ application.yaml
‚îÇ		        ‚îî‚îÄ‚îÄ repository.yaml
‚îú‚îÄ‚îÄ charts/
‚îÇ   ‚îî‚îÄ‚îÄ django-app/
‚îÇ       ‚îú‚îÄ‚îÄ templates/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ deployment.yaml
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ service.yaml
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ configmap.yaml
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ hpa.yaml
‚îÇ       ‚îú‚îÄ‚îÄ Chart.yaml
‚îÇ       ‚îî‚îÄ‚îÄ values.yaml     # ConfigMap –∑—ñ –∑–º—ñ–Ω–Ω–∏–º–∏ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
```

---

## üöÄ –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

### 1. –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ –≤–∏–º–æ–≥–∏
*   AWS CLI (–Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π `aws configure`)
*   Terraform (v1.0+)
*   kubectl
*   GitHub Personal Access Token (PAT) –∑ –ø—Ä–∞–≤–∞–º–∏ `repo`.

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö
–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `terraform.tfvars` —É –∫–æ—Ä–µ–Ω—ñ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó `lesson-8-9/`:

```hcl
github_pat = "ghp_YOUR_GITHUB_TOKEN_HERE"
```
> **–£–≤–∞–≥–∞:** –î–æ–¥–∞–π—Ç–µ `terraform.tfvars` —É `.gitignore`. –ù—ñ–∫–æ–ª–∏ –Ω–µ –∫–æ–º—ñ—Ç—å—Ç–µ —Å–µ–∫—Ä–µ—Ç–∏.

### 3. –ó–∞–ø—É—Å–∫ Terraform
–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–π—Ç–µ —Ç–∞ –∑–∞—Å—Ç–æ—Å—É–π—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é:

```bash
cd lesson-8-9
terraform init
terraform apply --auto-approve
```

–¶—è –∫–æ–º–∞–Ω–¥–∞:
1.  –°—Ç–≤–æ—Ä–∏—Ç—å –º–µ—Ä–µ–∂—É —Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä EKS.
2.  –°—Ç–≤–æ—Ä–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π ECR.
3.  –í—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Jenkins —Ç–∞ –Ω–∞–ª–∞—à—Ç—É—î Job'–∏ (JCasC).
4.  –í—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Argo CD —Ç–∞ –∑–∞—Ä–µ—î—Å—Ç—Ä—É—î Application `django-app`.

### 4. –î–æ—Å—Ç—É–ø –¥–æ —Å–µ—Ä–≤—ñ—Å—ñ–≤

#### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ (kubeconfig):
```bash
aws eks update-kubeconfig --region us-west-2 --name eks-cluster-demo
```

#### Jenkins:
```bash
# –û—Ç—Ä–∏–º–∞—Ç–∏ URL
kubectl get svc jenkins -n jenkins

# –õ–æ–≥—ñ–Ω/–ü–∞—Ä–æ–ª—å (–¥–µ—Ñ–æ–ª—Ç–Ω—ñ –∑ values.yaml)
User: admin
Pass: admin123
```

##### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Jenkins:
- –ó–∞–π–¥—ñ—Ç—å —É Jenkins (URL –∑ –≤–∏–≤–æ–¥—É Terraform).
- –ó–∞–ø—É—Å—Ç—ñ—Ç—å seed-job, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–∞–π–ø–ª–∞–π–Ω.
- –°—Ö–≤–∞–ª—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç —É Manage Jenkins -> In-process Script Approval.


#### Argo CD:
```bash
# –û—Ç—Ä–∏–º–∞—Ç–∏ URL (LoadBalancer)
kubectl get svc argo-cd-argocd-server -n argocd

# –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å admin (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π)
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d; echo
User: admin
```

#### CI/CD –ø—Ä–æ—Ü–µ—Å:
- –ó–∞–ø—É—Å—Ç—ñ—Ç—å –¥–∂–æ–±—É django-docker.
- Jenkins –∑–±–µ—Ä–µ –æ–±—Ä–∞–∑ —á–µ—Ä–µ–∑ Kaniko, –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å –π–æ–≥–æ –≤ ECR —Ç–∞ –æ–Ω–æ–≤–∏—Ç—å —Ç–µ–≥ —É values.yaml.


#### üìä –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- Jenkins: –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –æ—Å—Ç–∞–Ω–Ω—è –∑–±—ñ—Ä–∫–∞ django-docker –ø–æ–∑–Ω–∞—á–µ–Ω–∞ –∑–µ–ª–µ–Ω–∏–º –∫–æ–ª—å–æ—Ä–æ–º.
- Argo CD: –ó–∞–π–¥—ñ—Ç—å —É –¥–∞—à–±–æ—Ä–¥ Argo CD. –í–∏ –ø–æ–±–∞—á–∏—Ç–µ –¥–æ–¥–∞—Ç–æ–∫ django-app —É —Å—Ç–∞—Ç—É—Å—ñ Synced. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –∑–º—ñ–Ω–∏ –∑ Git –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç—ñ –≤ –∫–ª–∞—Å—Ç–µ—Ä—ñ.

–î–æ–¥–∞—Ç–æ–∫: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–æ–±–æ—Ç—É Django –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º –±–∞–ª–∞–Ω—Å—É–≤–∞–ª—å–Ω–∏–∫–∞: 
```bash
kubectl get svc django-app-service -n default
```

---

## üîÑ CI/CD Workflow (–Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î)

1.  **Code Change:** –†–æ–∑—Ä–æ–±–Ω–∏–∫ —Ä–æ–±–∏—Ç—å –∑–º—ñ–Ω–∏ –≤ –∫–æ–¥—ñ —Ç–∞ –ø—É—à–∏—Ç—å –≤ GitHub.
2.  **Jenkins Trigger:** `seed-job` (–∞–±–æ webhook) –∑–∞–ø—É—Å–∫–∞—î –ø–∞–π–ø–ª–∞–π–Ω `django-docker`.
3.  **Build:** Jenkins (Kaniko) –∑–±–∏—Ä–∞—î Docker-–æ–±—Ä–∞–∑.
4.  **Push:** –û–±—Ä–∞–∑ –ø—É—à–∏—Ç—å—Å—è –≤ AWS ECR –∑ —Ç–µ–≥–æ–º `v1.0.${BUILD_NUMBER}`.
5.  **Git Update:** Jenkins –∫–ª–æ–Ω—É—î —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∑ Helm-—á–∞—Ä—Ç–æ–º, –æ–Ω–æ–≤–ª—é—î `tag` —É —Ñ–∞–π–ª—ñ `charts/django-app/values.yaml` —ñ —Ä–æ–±–∏—Ç—å `git push`.
6.  **Argo Sync:** Argo CD (—è–∫–∏–π –º–æ–Ω—ñ—Ç–æ—Ä–∏—Ç—å Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π) –±–∞—á–∏—Ç—å –∑–º—ñ–Ω–∏ –≤ `values.yaml`.
7.  **Deployment:** Argo CD –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –∑–º—ñ–Ω–∏ –¥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ (–æ–Ω–æ–≤–ª—é—î Deployment, —â–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –Ω–æ–≤–∏–π –æ–±—Ä–∞–∑).

---

## üßπ –í–∏–¥–∞–ª–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤


```bash
terraform destroy --auto-approve
```
